# IISGeoLocate

## IISGeoLocate Introduction

IISGeoLocate can be used to geolocate IP addresses found in IIS Logs. IIS Logs can be located at `C:\inetpub\logs\LogFiles` on Windows Server machines.

### IISGeoLocate Use Cases

#### Law Enforcement

For those in Law Enforcement, this tool may not prove to be immediately useful, but should there be a case where IIS logs are relevant, this tool can parse them!

#### Private Sector

For those in the Private Sector, this tool is useful for parsing IIS logs and helping to identify unique IPs that can be geolocated and ran through useful resources like VirusTotal for IOC development. Additionally, this tool can convert the IIS logs from flat text to CSV format for better ingestion into Timeline Explorer.

<!-- TODO: need to expand this -->
<!-- TODO: need to use DFIRArtifactMuseum paths in commands used in Switch Descriptions section -->

{pagebreak}

## IISGeoLocate Switches

In a PowerShell window, running `.\IISGeoLocate.exe` will provide the following options when running IISGeoLocate:

{line-numbers:false}
```powershell
Description:
  iisgeolocate version 2.2.0.0

  Author: Eric Zimmerman (saericzimmerman@gmail.com)
  https://github.com/EricZimmerman/iisGeolocate

Usage:
  iisGeolocate [options]

Options:
  -d <d> (REQUIRED)       The directory that contains IIS logs. This will be recursively searched
                          for *.log files
  --csv <csv> (REQUIRED)  The directory to write results to
  --sbl                   When true, do NOT show bad lines to console (they are still logged to a
                          file) [default: False]
  --nul                   When true, do NOT create updated CSV files in --csv directory [default:
                          False]
  --version               Show version information
  -?, -h, --help          Show help and usage information

```

### Switch Descriptions

#### `--sbl`

This switch will instruct IISGeoLocate to not display bad lines to the console. These lines will still be written to the file being written to the location specified with the `--csv` switch.

`.\iisgeolocate.exe -d C:\inetpub\logs\LogFiles --csv C:\temp --sbl`

#### `--nul`

This switch will instruct IISGeoLocate to not update the CSV file at the location specified with the `--csv` switch.

`.\iisgeolocate.exe -d C:\inetpub\logs\LogFiles --csv C:\temp --nul true`

<!-- All other switches are covered by eztools_commonswitches.txt - 2022-09-15 -->

{pagebreak}

## IISGeoLocate Output

### Analyzing IISGeoLocate Output - CSV

IISGeoLocate will convert IIS logs into CSV format for ingestion into Timeline Explorer as well as adding IP geolocation data to each log entry.

{pagebreak}

## IISGeoLocate References

### Associated GitHub Repositories

* <https://github.com/EricZimmerman/iisGeolocate> is the GitHub repository for IISGeoLocate

### Download IISGeoLocate

IISGeoLocate can be downloaded from <https://ericzimmerman.github.io/#!index.md>
