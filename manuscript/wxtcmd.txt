# WxTCmd

## WxTCmd Introduction

WxTCmd is a tool created by Eric Zimmerman used to parse the [Windows Timeline](https://support.microsoft.com/en-us/windows/get-help-with-timeline-febc28db-034c-d2b0-3bbe-79aa0c501039). The Windows Timeline feature was added to Windows 10 with the 1804 (April 2018) feature update. The Windows Timeline can be found at the following location: `C:\Users\%User%\AppData\Local\ConnectedDevicesPlatform\L.CFUser\ActivitiesCache.db`.

### WxTCmd Use Cases

#### Law Enforcement

For those in Law Enforcement, this tool is useful for parsing Windows Timeline artifacts which can provide program execution activity that can be attributed to a specific user account. This can be useful for providing attribution of activity for various crimes involving media players, photo viewers, etc. Establish which Windows account the suspect was using during the time of interest and see what this artifact can provide to you.

#### Private Sector

For those in the Private Sector working ransomware cases, this tool is useful for parsing Windows Timeline artifacts which can provide program execution activity that can be attributed to a specific user account. For instance, an account compromised by a threat actor may have useful artifacts within the user of interest’s Windows Timeline.

For insider threat cases, this artifact can provide useful program execution artifacts that can be attributed to a specific user of interest. Any applications used by the user during the timeframe of interest may be recorded here so long as the events occurred within 30 days of acquiring the Windows Timeline artifact.

{pagebreak}

## WxTCmd Switches

In a PowerShell window, running `.\WxTCmd.exe` will provide the following options when running JLECmd:

{line-numbers:false}
```powershell
Description:
  WxTCmd version 1.0.0.0

  Author: Eric Zimmerman (saericzimmerman@gmail.com)
  https://github.com/EricZimmerman/WxTCmd

  Examples: WxTCmd.exe -f
  "C:\Users\eric\AppData\Local\ConnectedDevicesPlatform\L.eric\ActivitiesCache.db" --csv
  c:\temp

            Database files are typically found at
  'C:\Users\<profile>\AppData\Local\ConnectedDevicesPlatform\L.<profile>\ActivitiesCache.db'

            Short options (single letter) are prefixed with a single dash. Long commands are
  prefixed with two dashes

Usage:
  WxTCmd [options]

Options:
  -f <f>          File to process. Required
  --csv <csv>     Directory to save CSV formatted results to. Be sure to include the full
                  path in double quotes
  --dt <dt>       The custom date/time format to use when displaying timestamps. See
                  https://goo.gl/CNVq0k for options [default: yyyy-MM-dd HH:mm:ss]
  --debug         Show debug information during processing [default: False]
  --trace         Show trace information during processing [default: False]
  --version       Show version information
  -?, -h, --help  Show help and usage information


-f is required. Exiting
```

### Switch Descriptions

Thankfully, WxTCmd doesn't have any unique switches that aren't already covered in the common switches chapter.

{pagebreak}

## WxTCmd Command Examples

### Example WxTCmd Commands

#### Parse the Windows Timeline and Output to CSV to a Specified Location

{line-numbers:false}
```powershell
WxTCmd.exe -f "C:\Users\eric\AppData\Local\ConnectedDevicesPlatform\L.eric\ActivitiesCache.db" --csv c:\temp
```

{pagebreak}

## WxTCmd Output

### Analyzing WxTCmd Output - CSV

#### ‘%timestamp%_Activity_PackageIDs.csv‘

This CSV will contain GUIDs of applications that were executed on disk. Generally speaking, this CSV is not going to be as useful as the CSV highlighted below.

#### ‘%timestamp%__Activity.csv

This CSV will contain the Start Time and End Time of an application's execution by a given user. This database is user specific, so this activity can be associated with a specific user account. Additionally, there is a JSON payload for each entry within the Windows Timeline SQLite database that may provide further context for an entry within the database.

{pagebreak}

## WxTCmd Sample Output

{pagebreak}

## WxTCmd Key Takeaways

### Important Data Points

#### Timestamps

WxTCmd will output the following timestamps of interest:

 * StartTime - The timestamp of when the user opened an application
 * EndTime - The timestamp of when the user closed an application

{pagebreak}

## WxTCmd References

### Associated GitHub Repositories

* <https://github.com/EricZimmerman/WxTCmd> is the GitHub repo for WxTCmd

### Blog Posts

#### Official Blog Posts

Blog posts from Eric Zimmerman's blog, [Binary Foray](https://binaryforay.blogspot.com/):

* <https://binaryforay.blogspot.com/2018/05/introducing-wxtcmd.html>

#### Community Resources

* <https://niiconsulting.com/checkmate/2021/10/windows-timeline-putting-the-what-when-together/>
* <https://www.datadigitally.com/2019/04/windows-10-timeline-feature.html>
* <https://blog.group-ib.com/windows10_timeline_for_forensics>
* <https://andreafortuna.org/2019/10/03/some-forensic-thoughts-about-windows-10-timeline/>
* <https://tajdini.net/blog/forensics-and-security/windows-artifacts-for-forensics-investigation/>

### Download WxTCmd

WxTCmd can be downloaded from <https://ericzimmerman.github.io/#!index.md>

### Windows Timeline Sample Data

Sample Windows Timeline artifacts can be found at the [DFIRArtifactMuseum](https://github.com/AndrewRathbun/DFIRArtifactMuseum/tree/main/Windows/WindowsTimeline).