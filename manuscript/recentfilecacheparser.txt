# RecentFileCacheParser

## RecentFileCacheParser Introduction

RecentFileCacheParser is a tool created by Eric Zimmerman used to parse the RecentFileCache. The RecentFileCache can be located at `C:\Windows\AppCompat\Programs\RecentFileCache.bcf`.

<!-- TODO: need to expand this -->

{pagebreak}

## RecentFileCacheParser Switches

In a PowerShell window, running `.\RecentFileCacheParser.exe` will provide the following options when running RecentFileCacheParser:

{line-numbers:false}
```powershell
Description:
  RecentFileCacheParser version 1.5.0.0

  Author: Eric Zimmerman (saericzimmerman@gmail.com)
  https://github.com/EricZimmerman/RecentFileCacheParser

  Examples: RecentFileCacheParser.exe -f "C:\Temp\RecentFileCache.bcf" --csv "c:\temp"
            RecentFileCacheParser.exe -f "C:\Temp\RecentFileCache.bcf" --json "D:\jsonOutput"
  --jsonpretty

            Short options (single letter) are prefixed with a single dash. Long commands are prefixed
  with two dashes

Usage:
  RecentFileCacheParser [options]

Options:
  -f <f>          File to process. Required
  --csv <csv>     Directory to save CSV formatted results to. Be sure to include the full path in
                  double quotes
  --csvf <csvf>   File name to save CSV formatted results to. When present, overrides default name
  --json <json>   Directory to save json representation to. Use --pretty for a more human readable
                  layout
  --pretty        When exporting to json, use a more human readable layout [default: False]
  -q              Only show the filename being processed vs all output. Useful to speed up
                  exporting to json and/or csv [default: False]
  --version       Show version information
  -?, -h, --help  Show help and usage information


-f is required. Exiting
```

### Switch Descriptions

Thankfully, RecentFileCacheParser doesn't have any unique switches that aren't already covered in the common switches chapter.

{pagebreak}

## RecentFileCacheParser Command Examples

### Example RecentFileCacheParser Commands

#### Parse the RecentFileCache and output to CSV to a specified location

{line-numbers:false}
```powershell
RecentFileCacheParser.exe -f "C:\Temp\RecentFileCache.bcf" --csv "c:\temp"
```

#### Parse the RecentFileCache and output to JSON to a specified location

{line-numbers:false}
```powershell
RecentFileCacheParser.exe -f "C:\Temp\RecentFileCache.bcf" --json "D:\jsonOutput"
```

{pagebreak}

## RecentFileCacheParser Output

### Analyzing RecentFileCacheParser Output - Console

{line-numbers:false}
```powershell
Source file: D:\DFIRArtifactMuseum\Windows\RecentFileCache\Win7\EricZimmerman\RecentFileCache.bcf
  Source created:  2022-07-03 02:06:55
  Source modified: 2022-07-03 02:06:55
  Source accessed: 2022-09-09 17:11:42

File names
c:\windows\system32\werfault.exe
c:\program files\jetico\bcwipe\bcwipesvc.exe
c:\program files\jetico\bcwipe\bcwipetm.exe
c:\windows\system32\icacls.exe
c:\windows\system32\systempropertiesprotection.exe
c:\windows\bcuninstall.exe
```

{pagebreak}

### Analyzing RecentFileCacheParser Output - CSV

When executing RecentFileCacherParser with CSV output enabled, it will output a filename similar to the example below:

`%timestamp%_RecentFileCacheParser_Output.csv`

{pagebreak}

### Analyzing RecentFileCacheParser Output - JSON

When executing RecentFileCacherParser with JSON output enabled, it will produce output similar to the example below:

```json
{
	"SourceFile": "D:\\DFIRArtifactMuseum\\Windows\\RecentFileCache\\Win7\\EricZimmerman\\RecentFileCache.bcf",
	"SourceCreated": "\/Date(1656814015362)\/",
	"SourceModified": "\/Date(1656814015362)\/",
	"SourceAccessed": "\/Date(1662743665086)\/",
	"FileNames": [
		"c:\\windows\\system32\\werfault.exe",
		"c:\\program files\\jetico\\bcwipe\\bcwipesvc.exe",
		"c:\\program files\\jetico\\bcwipe\\bcwipetm.exe",
		"c:\\windows\\system32\\icacls.exe",
		"c:\\windows\\system32\\systempropertiesprotection.exe",
		"c:\\windows\\bcuninstall.exe"
	]
}
```

{pagebreak}

## RecentFileCacheParser References

### Associated GitHub Repositories

* <https://github.com/EricZimmerman/RecentFileCacheParser> is the GitHub repository for RecentFileCacheParser

### Download RecentFileCacheParser

RecentFileCacheParser can be downloaded from <https://ericzimmerman.github.io/#!index.md>

### RecentFileCache Sample Data

Sample RecentFileCache artifacts can be found at the [DFIRArtifactMuseum](https://github.com/AndrewRathbun/DFIRArtifactMuseum/tree/main/Windows/RecentFileCache).
