# LECmd - Key Takeaways

LECmd parses .LNK files, which are indicative of file access. .LNK files are created when a file is opened for the first time. If a .LNK file exists for a given file or folder, then that file or folder has been accessed at least once by a user.

LECmd output, regardless of file format, will provide potentially useful information about user activity on a given Windows system.

## Important Data Points

### Timestamps

LECmd output will provide the following timestamps:

 * SourceCreated - The creation timestamp associated with the .LNK file itself
 * SourceModified - The modified timestamp associated with the .LNK file itself
 * SourceAccessed - The accessed timestamp associated with the .LNK file itself
 * TargetCreated - The creation timestamp associated with the file the .LNK file points to
 * TargetModified - The modified timestamp associated with the file the .LNK file points to
 * TargetAccessed - The accessed timestamp associated with the file the .LNK file points to

SourceCreated will be the most useful indicator of when a file was first opened by a user. SourceModified will be the most useful indicator of when the file was last opened by a user.

The Target timestamps can be useful to cross reference with the timestamps in the MFT. Usually, these timestamps are the 0x10 ($Standard_Information) timestamps from the $MFT. In testing, it appears the timestamps stored within the .LNK file are “refreshed” when a file is opened again. The timestamps stored within a .LNK file are therefore a snapshop in time of when the .LNK file was last modified via opening a file. This can be useful in that if a file was timestomped (aka timestamps altered), those altered timestamps won’t reflect in the .LNK file until the timestomped file has been opened AFTER being timestomped.

### Other Attributes

#### SourceFile

SourceFile will provide the file path to the LNK file being parsed.

#### FileSize

FileSize will provide the file size of the target file that the .LNK file is pointing to.

#### WorkingDirectory

WorkingDirectory will provide the parent directory that the target file resides in.

#### DriveType

DriveType will provide insight as to what type of drive the SourceFile resided on at the time of file access.

#### VolumeSerialNumber

VolumeSerialNumber will provide the Volume Serial Number of the drive the target file resided on at the time of file access.

#### LocalPath

LocalPath will provide the full path to the target file that was accessed by the user. 

#### TargetMFTEntryNumber

TargetMFTEntryNumber will provide the MFT Entry number for the Target File in hexadecimal and decimal. 

#### TargetMFTSequenceNumber

TargetMFTSequenceNumber will provide the MFT Sequence number for the Target File in hexadecimal and decimal. 

#### MachineID

MachineID will provide the hostname of the hostnam the target file resided on at the time of file access, if the tracker database block is present within the LNK file.

#### MachineMACAddress

MachineMACAddress will provide the MAC Address for the host, if the tracker database block is present within the LNK file.

#### MACVendor

MACVendor will resolve the MAC address to provide the associated vendor, if known, and if the tracker database block is present within the LNK file..

#### ExtraBlocksPresent

ExtraBlocksPresent will provide insight as to whether or not extra data blocks are present within the LNK file. The other blocks that are possible to be present within a LNK file are: TrackerDataBaseBlock and PropertyStoreDataBlock.

#### TODO
FileAttributes
HeaderFlags
TargetIDAbsolutePath
TrackerCreatedOn
