# RBCmd

## RBCmd Introduction

RBCmd is a tool created by Eric Zimmerman used to parse the SUM database. The SUM database is located at `C:\Windows\System32\LogFiles\SUM` where multiple `*.mdb` files can be located.

### RBCmd Use Cases

#### Law Enforcement

For those in Law Enforcement, this tool is useful for parsing Recycle Bin files which can provide indications of what files were deleted when and by which user. This can be crucial for crimes involving contraband multimedia files as key evidence.

#### Private Sector

For those in the Private Sector, this tool is useful for parsing Recycle Bin files which can provide indications of what files a threat actor deleted before ending a period of unauthorized access. Often, there will be indicators of threat actor tool output having been deleted by a compromised user account within the Recycle Bin. This can help build out the timeline of events during a period of unauthorized access

<!-- TODO: need to expand this -->

{pagebreak}

## RBCmd Switches

In a PowerShell window, running `.\RBCmd.exe` will provide the following options when running RBCmd:

{line-numbers:false}
```powershell
Description:
  RBCmd version 1.5.0.0

  Author: Eric Zimmerman (saericzimmerman@gmail.com)
  https://github.com/EricZimmerman/RBCmd

  Examples: RBCmd.exe -f "C:\Temp\INFO2"
            RBCmd.exe -f "C:\Temp\$I3VPA17" --csv "D:\csvOutput"
            RBCmd.exe -d "C:\Temp" --csv "c:\temp"

            Short options (single letter) are prefixed with a single dash. Long commands are prefixed
  with two dashes


Usage:
  RBCmd [options]

Options:
  -d <d>          Directory to recursively process. Either this or -f is required
  -f <f>          File to process. Either this or -d is required
  -q              Only show the filename being processed vs all output. Useful to speed up
                  exporting to json and/or csv
  --csv <csv>     Directory to save CSV formatted results to. Be sure to include the full path in
                  double quotes
  --csvf <csvf>   File name to save CSV formatted results to. When present, overrides default name
  --dt <dt>       The custom date/time format to use when displaying time stamps. See
                  https://goo.gl/CNVq0k for options. Default is: yyyy-MM-dd HH:mm:ss [default:
                  yyyy-MM-dd HH:mm:ss]
  --debug         Show debug information during processing [default: False]
  --trace         Show trace information during processing [default: False]
  --version       Show version information
  -?, -h, --help  Show help and usage information


Either -f or -d is required. Exiting
```

### Switch Descriptions

Thankfully, RBCmd doesn't have any unique switches that aren't already covered in the common switches chapter.

## RBCmd Command Examples

### Example RBCmd Commands

#### Parse a legacy INFO2 Recycle Bin artifact and output to the console window

{line-numbers:false}
```powershell
RBCmd.exe -f "C:\Temp\INFO2"
```

#### Parse a $I file and output to CSV to a specified location

{line-numbers:false}
```powershell
RBCmd.exe -f "C:\Temp\$I3VPA17" --csv "D:\csvOutput"
```

#### Parse a directory of files and output to CSV to a specified location

{line-numbers:false}
```powershell
RBCmd.exe -d "C:\Temp" --csv "c:\temp"
```

{pagebreak}

## RBCmd Output

### Analyzing RBCmd Output - Console

When running RBCmd with no specified output, you will see an entry similar to the one below for each Recycle Bin artifact parsed:

```
Source file: C:\temp\$Recycle.Bin\S-1-5-21-868105201-2749328792-1957117261-1001\$IZUDHPA.md

Version: 2 (Windows 10/11)
File size: 304 (304B)
File name: C:\Users\CFUser\Documents\GitHub\DFIRArtifactMuseum\iOS\Address Book\iOS 14.1 - Hickman\README.md
Deleted on: 2022-05-13 16:29:11
```

### Analyzing RBCmd Output - CSV

When running RBCmd with CSV output, a CSV will be output with similar data that's output to the console.

## RBCmd Key Takeaways

### Important Data Points

The `Deleted On` timestamp will be useful in determining when a file was deleted by a specific user. The Recycle Bin metadata files can be tracked to a user by their SID. That way, one can attribute which user deleted the file a given metadata file is pointing to.

{pagebreak}

## RBCmd References

### Associated GitHub Repositories

* <https://github.com/EricZimmerman/RBCmd> is the GitHub repository for RBCmd

### Blog Posts

#### Official Blog Posts

Blog posts from Eric Zimmerman's blog, Binary Foray:

* [Quick Post: Notes on the Win10 Recycle Bin](https://thinkdfir.com/2018/11/23/quick-post-notes-on-the-win10-recycle-bin/)

### Download RBCmd

RBCmd can be downloaded from <https://ericzimmerman.github.io/#!index.md>

### Recycle Bin Sample Data

Sample Recycle Bin artifacts can be found at the [DFIRArtifactMuseum](https://github.com/AndrewRathbun/DFIRArtifactMuseum/tree/main/Windows/%24Recycle.Bin).